generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

enum DeliveryStatus {
  Initialized
  Intransit
  OutForDelivery
  Delivered
}

model User {
  id           String   @id @default(uuid())
  email        String   @unique
  name         String?
  passwordHash String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  profile UserProfile?
}

model Farmer {
  id           String         @id @default(uuid())
  name         String
  email        String         @unique
  passwordHash String
  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  profile      FarmerProfile?
  products     Products[]
}

model UserProfile {
  id             String   @id @default(uuid())
  userId         String   @unique
  bio            String?
  address_line_1 String
  address_line_2 String
  address_line_3 String
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  user User @relation(fields: [userId], references: [id])
}

model FarmerProfile {
  id         String   @id @default(uuid())
  farmerId   String   @unique
  bio        String?
  location   String
  trustScore Float    @default(0)
  rating     Float    @default(0)
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  farmer     Farmer   @relation(fields: [farmerId], references: [id])
}

model DeliveryAgent {
  id           String   @id @default(uuid())
  email        String   @unique
  passwordHash String   
  name         String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt



  profile     DeliveryAgentProfile?
}

model DeliveryAgentProfile {
  id           String @id @default(uuid())
  
  agentId      String @unique
  agent        DeliveryAgent  @relation(fields: [agentId],references: [id])
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Admin {
  id String @id @default(uuid())
}

model Products {
  id        String   @id @default(uuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  farnerId  String
  farner    Farmer   @relation(fields: [farnerId], references: [id])
}

model Order {
  id        String   @id @default(uuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  delivery  Delivery?
}

model OrderNFC {
  id        String   @id @default(uuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model OrderNFT {
  id        String   @id @default(uuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([id])
}

model Delivery {
  id String @id @default(uuid())
  orderId  String @unique
  order    Order @relation(fields: [orderId],references: [id])
  agentId  String @unique
  
  @@index([id])
}
